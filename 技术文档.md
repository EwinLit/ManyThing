# 项目概述

## 项目简介

在 RVBook（基于 openEuler 操作系统的 RISC-V 架构笔记本电脑）上开发一款具有 AI 驱动的文件管理工具，支持通过本地 AI 模型实现高效的文件分类与全局搜索功能。支持用户通过关键词、文件类型、日期等多维度进行文件检索。研发时间关系，本期可只支持文本文件，暂不需要支持二进制格式文件、图片等。

## 开发思路

主体部分使用Qt编写，Qt文件与数据库file.db交互。

数据库file.db由Qt调用Python程序生成。

## 组内分工



## github地址：

https://github.com/EwinLit/ManyThing

## 项目逻辑图

# 安装指南

## 运行环境

**CPU**：RISC-V

**操作系统**：openEuler

## 安装步骤

1. 按照**依赖管理**安装项目依赖

2. 解压项目到您指定的文件夹

3. 运行**excute.sh**启动程序

# 依赖管理

# 功能介绍

可通过关键词检索数据库，获取与关键词相关的文件列表，若关键词为空，则返回包含所有文件的列表。

可通过文件名、文件路径、文件大小、文件类型、文件最后修改时间对文件进行排序和反向排序。

可通过文件名、文件类型、文件最后修改时间对文件进行过滤。

在软件中可对doc、docx、pdf和文本文件的预览，可以一键双击打开文件所在目录。

# 代码结构

## Qt部分：

**【C++部分约700行，xml部分共约260行】**

### MyTime：

字段：

```c++
private:
    int year,month,day;
    int hour,minute,second;
```

方法：

```c++
public:
    MyTime();//默认构造函数
    MyTime(QString);//通过字符串构造对象
    MyTime(int,int,int,int,int,int);//通过6个整数构造对象
    MyTime& operator=(const MyTime& obl);//重载，以实现变量间赋值
    bool operator>(const MyTime& obj);//重载，以实现排序
    bool operator<=(const MyTime& obj);//重载，以实现排序
    int getyear();//get方法
    int getmonth();//get方法
    int getday();//get方法
    int getHour();//get方法
    int getMinute();//get方法
    int getSecond();//get方法
    QString toString();//转化成字符串，便于打印
```

### MyFile：

字段：

```c++
private:
    QString name;
    QString path;
    double size;
    MyTime editTime;
    QString type;
```

方法：

```c++
public:
    MyFile(QString,QString,double,MyTime,QString);//根据每个字段的值初始化对象
    QString getName();//get方法
    QString getPath();//get方法
    QString getSize();//get方法
    double getDoubleSize();//get方法，返回双精度实型，以便排序
    QDateTime getMyEditTime();//get方法，返回QdateTime类型，以便排序
    QString getEditTime();//get方法
    QString getType();//get方法
    QDate getDate();//get方法
    QString toString();//转化成字符串，便于打印
```

### MySqlite：

字段：

```c++
private:
    QSqlDatabase db；
```

方法：

```c++
private:
    QList<MyFile> queryFile(QString,QString);//查询数据库表file
public:   
    MySqlite();//默认构造函数
    bool connectDataBase(QString);//连接数据库
    QList<MyFile> queryKeyWord(QString);//查询数据库表keyword
    void test();//测试使用
```

### MainWindow：

字段：

```c++
private:
    Ui::MainWindow *ui;
    QList<MyFile> myFileList;
    MySqlite dataBase;
    int sortStatus;
public:
    bool success;
```

方法：

```c++
public:
    MainWindow(QWidget *parent = nullptr);//构造函数
    ~MainWindow();//析构函数

private:
    //mainwindow.cpp
    void refreshTable(bool reverse);//刷新tableWidget
    void echoInfo(QString info);//设置statusBar
    void setIcon(int choice);//设置actionbutton的图标
    void setTestBrowser(int row);//设置testBrowser的文字

    //support.cpp
    void sortName();//根据name排序
    void sortSize();//根据size排序
    void sortPath();//根据path排序
    void sortEditTime();//根据editTime排序
    void sortType();//根据type排序
    void filtrate(QString,QString,QDate);//根据时间/名字/扩展名筛选
    void search(QString);//根据关键词搜索数据库
    void openFile(int,int);//处理单击tableWidget单元格事件
    void handleCell(int,int);//处理双击tableWidget单元格事件
    void about();//显示作者信息
    void help();//显示帮助，【未实现】
    void reverse(bool);//反转tableWidget
    void refreshDataBase();//刷新数据库
    void horizontalSort(int);//点击表头排序
    void executePython(QString);//运行Python程序
    void installTools();//安装插件，【未实现】
```

## Python部分：

# 数据库：

**数据库使用Sqlite。**

## Table1：files

**主键为：[path,name]**

| 字段   | 类型   |
|:----:|:----:|
| name | TEXT |
| path | TEXT |
| size | REAL |
| type | TEXT |
| time | TEXT |

## Table2：keyword

**主键为id，外键为[path,name]**

| 字段   | 类型      |
|:----:|:-------:|
| word | TEXT    |
| path | TEXT    |
| time | TEXT    |
| id   | INTEGER |
